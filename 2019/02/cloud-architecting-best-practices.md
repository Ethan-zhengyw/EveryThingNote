# 云架构最佳实践

## 传统IT环境 vs 云计算环境

### IT资产供给

#### 灵活按需、高利用率、全球性

### 高层抽象服务化

### 内建安全

### 成本控制

### 操作方式

## 设计原则

### 可扩展性

#### 水平扩展与横向扩展

#### 无状态应用与有状态应用

##### 会话数据

###### 客户端浏览器Cookie

####### 网络带宽性能损耗

####### 数据不可信

###### 服务端SessionID + Session

####### 分支主题

##### 中心化存储会话数据，避免引入有状态应用

###### DB

###### S3、EFS

##### 有状态应用LB

###### 按sessionID进行负载均衡，与计算资源配置亲和性规则

####### 已存在的session无法被重新分配（可改进）

####### 指定了计算资源，可靠性下降

###### 客户端负载均衡

####### 请求获取服务endpoint

#### 请求任务分发模型 Push vs Pull

##### Push —— LB

##### Pull

###### DB

###### MQ

###### DB vs MQ

####### 通常选择数据库作为任务队列的一个原因是——环境里已经有数据库了，不需要再引入新的MQ组件，涉及到增加维护工作的问题

####### 使用DB进行开发项目进展会更快？

####### 但是，使用数据库作为消息队列不是一个可扩展的解决方案？

######## 可扩展性当前是否真的那么重要？

######## MQ是否可以在项目后续有真正的可扩展性需求时再通过架构演进引入

### 一次性的资源替代固定的服务器

#### 降低成本

#### 避免“配置漂移”

#### 基础设施安全性得到提高

### 自动化

### 松耦合

#### 好的接口设计

#### 服务发现

#### 异步集成与处理

#### 分布式系统最佳实践

##### 优雅失败

###### 重试

###### 转移请求/重定向

### 服务，而不是服务器

#### 充分利用云服务提供的能力提高系统的可靠性、安全性、可运维性

### 数据库

### 处理增长的数据

### 消除单点故障

### 成本优化

### 缓存

### 安全性

## 总结

## 参考链接

### https://d1.awsstatic-china.com/whitepapers/AWS_Cloud_Best_Practices.pdf

### https://www.cloudamqp.com/blog/2015-11-23-why-is-a-database-not-the-right-tool-for-a-queue-based-system.html

### https://dev.to/matteojoliveau/microservices-communications-why-you-should-switch-to-message-queues--48ia
